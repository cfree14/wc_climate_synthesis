# Axis
scale_x_continuous(breaks=seq(1990,2020,5)) +
# Labels
labs(x="Year", y="") +
# Legends
scale_color_discrete(name="Diaster cause") +
scale_size_continuous(name="Number of disasters", breaks=c(1,2,3), range=c(1.5,4)) +
scale_shape_manual(name="Status")
# Plot data
g <- ggplot(stats, aes(x=disaster_year1, y=species,
color=cause_catg, size=n_disasters, shape=determination)) +
# Facet
facet_grid(taxa_group~region, space="free", scales="free_y") +
# Plot MHW years
geom_rect(xmin=2014.5, xmax=2018.5, ymin=1, ymax=20, fill="grey90", inherit.aes = F) +
# Plot disasters
geom_point() +
# Axis
scale_x_continuous(breaks=seq(1990,2020,5)) +
# Labels
labs(x="Year", y="") +
# Legends
scale_color_discrete(name="Diaster cause") +
scale_size_continuous(name="Number of disasters", breaks=c(1,2,3), range=c(1.5,4)) +
scale_shape_manual(name="Status", values=c(3, 4, 1, 16))
# Plot data
g <- ggplot(stats, aes(x=disaster_year1, y=species,
color=cause_catg, size=n_disasters, shape=determination)) +
# Facet
facet_grid(taxa_group~region, space="free", scales="free_y") +
# Plot MHW years
geom_rect(xmin=2014.5, xmax=2018.5, ymin=1, ymax=20, fill="grey90", inherit.aes = F) +
# Plot disasters
geom_point() +
# Axis
scale_x_continuous(breaks=seq(1990,2020,5)) +
# Labels
labs(x="Year", y="") +
# Legends
scale_color_discrete(name="Diaster cause") +
scale_size_continuous(name="Number of disasters", breaks=c(1,2,3), range=c(1.5,4)) +
scale_shape_manual(name="Status", values=c(3, 4, 1, 16)) +
# Theme
theme_bw()
g
# Build stats
stats <- data_exp %>%
# Summarize
group_by(region, species, disaster_year1, cause_catg, determination) %>%
summarize(n_disasters=n()) %>%
ungroup() %>%
# Add taxa
mutate(taxa_group=ifelse(grepl("salmon", tolower(species)), "Salmon",
ifelse(grepl("urchin|crab|scallop", tolower(species)), "Invertebrate", "Other"))) %>%
# Factor cause
mutate(cause_catg=factor(cause_catg, levels=c("Human", 'Environmental', "Human/environmental", "Not officially determined"))) %>%
# Factor determination
mutate(determination=determination, levels=c("TBD", "Denied", "Partially approved", "Approved"))
# Build stats
stats <- data_exp %>%
# Summarize
group_by(region, species, disaster_year1, cause_catg, determination) %>%
summarize(n_disasters=n()) %>%
ungroup() %>%
# Add taxa
mutate(taxa_group=ifelse(grepl("salmon", tolower(species)), "Salmon",
ifelse(grepl("urchin|crab|scallop", tolower(species)), "Invertebrate", "Other"))) %>%
# Factor cause
mutate(cause_catg=factor(cause_catg, levels=c("Human", 'Environmental', "Human/environmental", "Not officially determined"))) %>%
# Factor determination
mutate(determination=factor(determination, levels=c("TBD", "Denied", "Partially approved", "Approved")))
# Plot data
g <- ggplot(stats, aes(x=disaster_year1, y=species,
color=cause_catg, size=n_disasters, shape=determination)) +
# Facet
facet_grid(taxa_group~region, space="free", scales="free_y") +
# Plot MHW years
geom_rect(xmin=2014.5, xmax=2018.5, ymin=1, ymax=20, fill="grey90", inherit.aes = F) +
# Plot disasters
geom_point() +
# Axis
scale_x_continuous(breaks=seq(1990,2020,5)) +
# Labels
labs(x="Year", y="") +
# Legends
scale_color_discrete(name="Diaster cause") +
scale_size_continuous(name="Number of disasters", breaks=c(1,2,3), range=c(1.5,4)) +
scale_shape_manual(name="Status", values=c(3, 4, 1, 16)) +
# Theme
theme_bw()
g
# Build stats
stats <- data_exp %>%
# Summarize
group_by(region, species, disaster_year1, cause_catg, determination) %>%
summarize(n_disasters=n()) %>%
ungroup() %>%
# Add taxa
mutate(taxa_group=ifelse(grepl("salmon", tolower(species)), "Salmon",
ifelse(grepl("urchin|crab|scallop", tolower(species)), "Invertebrate", "Other"))) %>%
# Factor cause
mutate(cause_catg=factor(cause_catg, levels=c("Human", 'Environmental', "Human/environmental", "Not officially determined"))) %>%
# Factor determination
mutate(determination=stringr::str_to_sentence(determination),
determination=factor(determination, levels=c("TBD", "Denied", "Partially approved", "Approved")))
# Plot data
g <- ggplot(stats, aes(x=disaster_year1, y=species,
color=cause_catg, size=n_disasters, shape=determination)) +
# Facet
facet_grid(taxa_group~region, space="free", scales="free_y") +
# Plot MHW years
geom_rect(xmin=2014.5, xmax=2018.5, ymin=1, ymax=20, fill="grey90", inherit.aes = F) +
# Plot disasters
geom_point() +
# Axis
scale_x_continuous(breaks=seq(1990,2020,5)) +
# Labels
labs(x="Year", y="") +
# Legends
scale_color_discrete(name="Diaster cause") +
scale_size_continuous(name="Number of disasters", breaks=c(1,2,3), range=c(1.5,4)) +
scale_shape_manual(name="Status", values=c(3, 4, 1, 16)) +
# Theme
theme_bw()
g
# Build stats
stats <- data_exp %>%
# Summarize
group_by(region, species, disaster_year1, cause_catg, determination) %>%
summarize(n_disasters=n()) %>%
ungroup() %>%
# Add taxa
mutate(taxa_group=ifelse(grepl("salmon", tolower(species)), "Salmon",
ifelse(grepl("urchin|crab|scallop", tolower(species)), "Invertebrate", "Other"))) %>%
# Factor cause
mutate(cause_catg=factor(cause_catg, levels=c("Human", 'Environmental', "Human/environmental", "Not officially determined"))) %>%
# Factor determination
mutate(determination=stringr::str_to_sentence(determination),
determination=factor(determination, levels=c("TBD", "Denied", "Partially approved", "Approved")))
# Plot data
g <- ggplot(stats, aes(x=disaster_year1, y=species,
color=cause_catg, size=n_disasters, shape=determination)) +
# Facet
facet_grid(taxa_group~region, space="free", scales="free_y") +
# Plot MHW years
geom_rect(xmin=2014.5, xmax=2018.5, ymin=1, ymax=20, fill="grey90", inherit.aes = F) +
# Plot disasters
geom_point() +
# Axis
scale_x_continuous(breaks=seq(1990,2020,5)) +
# Labels
labs(x="Year", y="") +
# Legends
scale_color_discrete(name="Diaster cause") +
scale_size_continuous(name="Number of disasters", breaks=c(1,2,3), range=c(1.5,4)) +
scale_shape_manual(name="Status", values=c(3, 4, 1, 16)) +
# Theme
theme_bw()
g
# Build stats
stats <- data_exp %>%
# Summarize
group_by(region, species, disaster_year1, cause_catg, determination) %>%
summarize(n_disasters=n()) %>%
ungroup() %>%
# Add taxa
mutate(taxa_group=ifelse(grepl("salmon", tolower(species)), "Salmon",
ifelse(grepl("urchin|crab|scallop", tolower(species)), "Invertebrate", "Other"))) %>%
# Factor cause
mutate(cause_catg=factor(cause_catg, levels=c("Human", 'Environmental', "Human/environmental", "Not officially determined"))) %>%
# Factor determination
mutate(determination=recode(determination, "Partially Approved"="Partially approved")),
determination=factor(determination, levels=c("TBD", "Denied", "Partially approved", "Approved")))
# Build stats
stats <- data_exp %>%
# Summarize
group_by(region, species, disaster_year1, cause_catg, determination) %>%
summarize(n_disasters=n()) %>%
ungroup() %>%
# Add taxa
mutate(taxa_group=ifelse(grepl("salmon", tolower(species)), "Salmon",
ifelse(grepl("urchin|crab|scallop", tolower(species)), "Invertebrate", "Other"))) %>%
# Factor cause
mutate(cause_catg=factor(cause_catg, levels=c("Human", 'Environmental', "Human/environmental", "Not officially determined"))) %>%
# Factor determination
mutate(determination=recode(determination, "Partially Approved"="Partially approved"),
determination=factor(determination, levels=c("TBD", "Denied", "Partially approved", "Approved")))
# Plot data
g <- ggplot(stats, aes(x=disaster_year1, y=species,
color=cause_catg, size=n_disasters, shape=determination)) +
# Facet
facet_grid(taxa_group~region, space="free", scales="free_y") +
# Plot MHW years
geom_rect(xmin=2014.5, xmax=2018.5, ymin=1, ymax=20, fill="grey90", inherit.aes = F) +
# Plot disasters
geom_point() +
# Axis
scale_x_continuous(breaks=seq(1990,2020,5)) +
# Labels
labs(x="Year", y="") +
# Legends
scale_color_discrete(name="Diaster cause") +
scale_size_continuous(name="Number of disasters", breaks=c(1,2,3), range=c(1.5,4)) +
scale_shape_manual(name="Status", values=c(3, 4, 1, 16)) +
# Theme
theme_bw()
g
View(data)
# Setup theme
my_theme <-  theme(axis.text=element_text(size=6),
axis.title=element_text(size=8),
legend.text=element_text(size=6),
legend.title=element_text(size=8),
strip.text=element_text(size=8),
plot.title=element_text(size=10),
# Gridlines
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
# Legend
legend.background = element_rect(fill=alpha('blue', 0)))
# Plot data
g <- ggplot(stats, aes(x=disaster_year1, y=species,
color=cause_catg, size=n_disasters, shape=determination)) +
# Facet
facet_grid(taxa_group~region, space="free", scales="free_y") +
# Plot MHW years
geom_rect(xmin=2014.5, xmax=2018.5, ymin=1, ymax=20, fill="grey90", inherit.aes = F) +
# Plot disasters
geom_point() +
# Axis
scale_x_continuous(breaks=seq(1990,2020,5)) +
# Labels
labs(x="Year", y="") +
# Legends
scale_color_discrete(name="Diaster cause") +
scale_size_continuous(name="Number of disasters", breaks=c(1,2,3), range=c(1.5,4)) +
scale_shape_manual(name="Status", values=c(3, 4, 1, 16)) +
# Theme
theme_bw() + my_theme
g
# Setup theme
my_theme <-  theme(axis.text=element_text(size=7),
axis.title=element_text(size=9),
legend.text=element_text(size=7),
legend.title=element_text(size=9),
strip.text=element_text(size=9),
# Gridlines
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
# Legend
legend.background = element_rect(fill=alpha('blue', 0)))
# Plot data
g <- ggplot(stats, aes(x=disaster_year1, y=species,
color=cause_catg, size=n_disasters, shape=determination)) +
# Facet
facet_grid(taxa_group~region, space="free", scales="free_y") +
# Plot MHW years
geom_rect(xmin=2014.5, xmax=2018.5, ymin=1, ymax=20, fill="grey90", inherit.aes = F) +
# Plot disasters
geom_point() +
# Axis
scale_x_continuous(breaks=seq(1990,2020,5)) +
# Labels
labs(x="Year", y="") +
# Legends
scale_color_discrete(name="Diaster cause") +
scale_size_continuous(name="Number of disasters", breaks=c(1,2,3), range=c(1.5,4)) +
scale_shape_manual(name="Status", values=c(3, 4, 1, 16)) +
# Theme
theme_bw() + my_theme
g
# Export plot
ggsave(g, filename=file.path(plotdir, "wc_federal_fisheries_disasters.png"),
width=6.5, height=4, units="in", dpi=600)
# Setup theme
my_theme <-  theme(axis.text=element_text(size=7),
axis.title=element_text(size=8),
legend.text=element_text(size=7),
legend.title=element_text(size=8),
strip.text=element_text(size=8),
# Gridlines
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
# Legend
legend.background = element_rect(fill=alpha('blue', 0)))
# Plot data
g <- ggplot(stats, aes(x=disaster_year1, y=species,
color=cause_catg, size=n_disasters, shape=determination)) +
# Facet
facet_grid(taxa_group~region, space="free", scales="free_y") +
# Plot MHW years
geom_rect(xmin=2014.5, xmax=2018.5, ymin=1, ymax=20, fill="grey90", inherit.aes = F) +
# Plot disasters
geom_point() +
# Axis
scale_x_continuous(breaks=seq(1990,2020,5)) +
# Labels
labs(x="Year", y="") +
# Legends
scale_color_discrete(name="Diaster cause") +
scale_size_continuous(name="Number of disasters", breaks=c(1,2,3), range=c(1.5,4)) +
scale_shape_manual(name="Status", values=c(3, 4, 1, 16)) +
# Theme
theme_bw() + my_theme
g
# Export plot
ggsave(g, filename=file.path(plotdir, "wc_federal_fisheries_disasters.png"),
width=6.5, height=4, units="in", dpi=600)
# Plot data
g <- ggplot(stats, aes(x=disaster_year1, y=species,
color=cause_catg, size=n_disasters, shape=determination)) +
# Facet
facet_grid(taxa_group~region, space="free", scales="free_y") +
# Plot MHW years
geom_rect(xmin=2014.5, xmax=2018.5, ymin=1, ymax=20, fill="grey90", inherit.aes = F) +
# Plot disasters
geom_point() +
# Axis
scale_x_continuous(breaks=seq(1990,2020,5)) +
# Labels
labs(x="Year", y="") +
# Legends
scale_color_discrete(name="Diaster cause") +
scale_size_continuous(name="Number of disasters", breaks=c(1,2,3), range=c(1.5,4)) +
scale_shape_manual(name="Status", values=c(3, 4, 1, 16)) +
guides(color = guide_legend(order = 2), size = guide_legend(order = 1), shape = guide_legend(order = 3))
# Theme
theme_bw() + my_theme
g
# Plot data
g <- ggplot(stats, aes(x=disaster_year1, y=species,
color=cause_catg, size=n_disasters, shape=determination)) +
# Facet
facet_grid(taxa_group~region, space="free", scales="free_y") +
# Plot MHW years
geom_rect(xmin=2014.5, xmax=2018.5, ymin=1, ymax=20, fill="grey90", inherit.aes = F) +
# Plot disasters
geom_point() +
# Axis
scale_x_continuous(breaks=seq(1990,2020,5)) +
# Labels
labs(x="Year", y="") +
# Legends
scale_color_discrete(name="Diaster cause") +
scale_size_continuous(name="Number of disasters", breaks=c(1,2,3), range=c(1.5,4)) +
scale_shape_manual(name="Status", values=c(3, 4, 1, 16)) +
guides(color = guide_legend(order = 2), size = guide_legend(order = 1), shape = guide_legend(order = 3))  +
# Theme
theme_bw() + my_theme
g
# Export plot
ggsave(g, filename=file.path(plotdir, "wc_federal_fisheries_disasters.png"),
width=6.5, height=4, units="in", dpi=600)
# Plot data
g <- ggplot(stats, aes(x=disaster_year1, y=species,
color=cause_catg, size=n_disasters, shape=determination)) +
# Facet
facet_grid(taxa_group~region, space="free", scales="free_y") +
# Plot MHW years
geom_rect(xmin=2014.5, xmax=2018.5, ymin=1, ymax=20, fill="grey90", inherit.aes = F) +
# Plot disasters
geom_point() +
# Axis
scale_x_continuous(breaks=seq(1990,2020,5)) +
# Labels
labs(x="Year", y="") +
# Legends
scale_color_discrete(name="Diaster cause") +
scale_size_continuous(name="Number of disasters", breaks=c(1,2,3), range=c(1.5,4)) +
scale_shape_manual(name="Status", values=c(3, 4, 1, 16)) +
guides(color = guide_legend(order = 2), size = guide_legend(order = 1), shape = guide_legend(order = 3))  +
# Theme
theme_bw() + my_theme
g
# Export plot
ggsave(g, filename=file.path(plotdir, "wc_federal_fisheries_disasters.png"),
width=6.5, height=4, units="in", dpi=600)
# Species order
species_order <- c("Snow crab", "Tanner crab", "Red king crab", "Rock crab", "Dungeness crab", "Red sea urchin", "Scallop",
"Groundfish", "Pacific cod", "Pacific sardine",
"Salmon", "Pink salmon", "Coho salmon", "Chum salmon", "Chinook salmon", "Sockeye salmon")
# Build stats
stats <- data_exp %>%
# Summarize
group_by(region, species, disaster_year1, cause_catg, determination) %>%
summarize(n_disasters=n()) %>%
ungroup() %>%
# Add taxa
mutate(taxa_group=ifelse(grepl("salmon", tolower(species)), "Salmon",
ifelse(grepl("urchin|crab|scallop", tolower(species)), "Invertebrate", "Other"))) %>%
# Factor cause
mutate(cause_catg=factor(cause_catg, levels=c("Human", 'Environmental', "Human/environmental", "Not officially determined"))) %>%
# Factor determination
mutate(determination=recode(determination, "Partially Approved"="Partially approved"),
determination=factor(determination, levels=c("TBD", "Denied", "Partially approved", "Approved"))) %>%
# Order species
mutate(species=factor(species, levels=species_order))
# Setup theme
my_theme <-  theme(axis.text=element_text(size=7),
axis.title=element_text(size=8),
legend.text=element_text(size=7),
legend.title=element_text(size=8),
strip.text=element_text(size=8),
# Gridlines
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
# Legend
legend.background = element_rect(fill=alpha('blue', 0)))
# Plot data
g <- ggplot(stats, aes(x=disaster_year1, y=species,
color=cause_catg, size=n_disasters, shape=determination)) +
# Facet
facet_grid(taxa_group~region, space="free", scales="free_y") +
# Plot MHW years
geom_rect(xmin=2014.5, xmax=2018.5, ymin=1, ymax=20, fill="grey90", inherit.aes = F) +
# Plot disasters
geom_point() +
# Axis
scale_x_continuous(breaks=seq(1990,2020,5)) +
# Labels
labs(x="Year", y="") +
# Legends
scale_color_discrete(name="Diaster cause") +
scale_size_continuous(name="Number of disasters", breaks=c(1,2,3), range=c(1.5,4)) +
scale_shape_manual(name="Status", values=c(3, 4, 1, 16)) +
guides(color = guide_legend(order = 2), size = guide_legend(order = 1), shape = guide_legend(order = 3))  +
# Theme
theme_bw() + my_theme
g
# Build stats
stats <- data_exp %>%
# Summarize
group_by(region, species, disaster_year1, cause_catg, determination) %>%
summarize(n_disasters=n()) %>%
ungroup() %>%
# Add taxa
mutate(taxa_group=ifelse(grepl("salmon", tolower(species)), "Salmon",
ifelse(grepl("urchin|crab|scallop", tolower(species)), "Invertebrate", "Other"))) %>%
# Factor cause
mutate(cause_catg=factor(cause_catg, levels=c("Human", 'Environmental', "Human/environmental", "Not officially determined"))) %>%
# Factor determination
mutate(determination=recode(determination, "Partially Approved"="Partially approved"),
determination=factor(determination, levels=c("TBD", "Denied", "Partially approved", "Approved"))) %>%
# Order species
mutate(species=factor(species, levels=rev(species_order)))
# Setup theme
my_theme <-  theme(axis.text=element_text(size=7),
axis.title=element_text(size=8),
legend.text=element_text(size=7),
legend.title=element_text(size=8),
strip.text=element_text(size=8),
# Gridlines
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
# Legend
legend.background = element_rect(fill=alpha('blue', 0)))
# Plot data
g <- ggplot(stats, aes(x=disaster_year1, y=species,
color=cause_catg, size=n_disasters, shape=determination)) +
# Facet
facet_grid(taxa_group~region, space="free", scales="free_y") +
# Plot MHW years
geom_rect(xmin=2014.5, xmax=2018.5, ymin=1, ymax=20, fill="grey90", inherit.aes = F) +
# Plot disasters
geom_point() +
# Axis
scale_x_continuous(breaks=seq(1990,2020,5)) +
# Labels
labs(x="Year", y="") +
# Legends
scale_color_discrete(name="Diaster cause") +
scale_size_continuous(name="Number of disasters", breaks=c(1,2,3), range=c(1.5,4)) +
scale_shape_manual(name="Status", values=c(3, 4, 1, 16)) +
guides(color = guide_legend(order = 2), size = guide_legend(order = 1), shape = guide_legend(order = 3))  +
# Theme
theme_bw() + my_theme
g
# Plot data
g <- ggplot(stats, aes(x=disaster_year1, y=species,
color=cause_catg, size=n_disasters, shape=determination)) +
# Facet
facet_grid(taxa_group~region, space="free", scales="free_y") +
# Plot MHW years
geom_rect(xmin=2014.5, xmax=2018.5, ymin=1, ymax=20, fill="grey90", inherit.aes = F) +
# Plot disasters
geom_point() +
# Axis
scale_x_continuous(breaks=seq(1990,2020,5)) +
# Labels
labs(x="Year", y="") +
# Legends
scale_color_discrete(name="Diaster cause") +
scale_size_continuous(name="Number of disasters", breaks=c(1,2,3), range=c(1.5,4)) +
scale_shape_manual(name="Status", values=c(3, 4, 1, 16)) +
guides(color = guide_legend(order = 2), size = guide_legend(order = 1), shape = guide_legend(order = 3))  +
# Theme
theme_bw() + my_theme
g
# Export plot
ggsave(g, filename=file.path(plotdir, "wc_federal_fisheries_disasters.png"),
width=6.5, height=4, units="in", dpi=600)
sample(1:9)
